<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Full Tanker</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: #1f2937;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
      animation: fadeInDown 0.6s ease;
    }
    
    .header h1 {
      font-size: 42px;
      color: white;
      margin-bottom: 8px;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    
    .header p {
      color: rgba(255,255,255,0.9);
      font-size: 16px;
    }
    
    .card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      animation: fadeInUp 0.6s ease;
      backdrop-filter: blur(10px);
    }
    
    .input-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .input-group {
      position: relative;
    }
    
    .input-group label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: #6b7280;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .input-group input[type="number"] {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e5e7eb;
      border-radius: 10px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: #f9fafb;
    }
    
    .input-group input[type="number"]:focus {
      outline: none;
      border-color: #667eea;
      background: white;
      box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
    }
    
    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px;
      background: #f3f4f6;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .checkbox-wrapper:hover {
      background: #e5e7eb;
    }
    
    .checkbox-wrapper input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: #667eea;
    }
    
    .checkbox-wrapper label {
      font-weight: 500;
      cursor: pointer;
      user-select: none;
    }
    
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102,126,234,0.4);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    
    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16,185,129,0.4);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
    }
    
    .btn-danger:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(239,68,68,0.4);
    }
    
    .status-message {
      padding: 15px 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-weight: 500;
      animation: slideIn 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .status-success {
      background: #d1fae5;
      color: #065f46;
      border-left: 4px solid #10b981;
    }
    
    .status-error {
      background: #fee2e2;
      color: #991b1b;
      border-left: 4px solid #ef4444;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .stat-card {
      background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      transition: transform 0.3s ease;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
    }
    
    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 14px;
      color: #6b7280;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 20px;
    }
    
    thead {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    th {
      padding: 15px 12px;
      text-align: right;
      font-weight: 600;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    th:first-child {
      text-align: left;
      border-top-left-radius: 10px;
    }
    
    th:last-child {
      border-top-right-radius: 10px;
    }
    
    td {
      padding: 15px 12px;
      text-align: right;
      border-bottom: 1px solid #f3f4f6;
    }
    
    td:first-child {
      text-align: left;
      font-weight: 600;
      color: #667eea;
    }
    
    tbody tr {
      transition: background 0.2s ease;
    }
    
    tbody tr:hover {
      background: #f9fafb;
    }
    
    .chart-container {
      margin-top: 30px;
      padding: 20px;
      background: #f9fafb;
      border-radius: 15px;
    }
    
    h2 {
      font-size: 24px;
      color: #1f2937;
      margin-bottom: 20px;
      font-weight: 700;
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    @media (max-width: 768px) {
      .header h1 {
        font-size: 32px;
      }
      
      .card {
        padding: 20px;
      }
      
      .button-group {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üõµ Full Tanker</h1>
      <p>Track your fuel efficiency with style</p>
    </div>

    <div class="card">
      <div id="statusMessage"></div>

      <div class="input-section">
        <div class="input-group">
          <label>Odometer Reading</label>
          <input type="number" id="odometer" placeholder="Enter km" step="0.1" />
        </div>
        <div class="input-group">
          <label>Fuel Filled</label>
          <input type="number" id="liters" placeholder="Enter liters" step="0.1" />
        </div>
        <div class="input-group">
          <label>Price Paid</label>
          <input type="number" id="price" placeholder="Enter ‚Çπ" step="0.01" />
        </div>
        <div class="checkbox-wrapper">
          <input type="checkbox" id="fullTank" />
          <label for="fullTank">Full Tank</label>
        </div>
      </div>

      <div class="button-group">
        <button class="btn btn-primary" onclick="addEntry()">
          ‚ûï Add Entry
        </button>
        <button class="btn btn-success" onclick="downloadData()">
          üíæ Backup JSON
        </button>
        <button class="btn btn-success" onclick="exportCSV()">
          üìä Export CSV
        </button>
        <button class="btn btn-danger" onclick="resetAll()">
          üóëÔ∏è Reset All
        </button>
      </div>
    </div>

    <div class="card">
      <h2>üìä Statistics</h2>
      <div class="stats-grid" id="statsGrid"></div>
    </div>

    <div class="card">
      <h2>üìù Refuel History</h2>
      <div id="historyContent"></div>
      <div class="chart-container">
        <canvas id="mileageChart"></canvas>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let entries = [];

    function showStatus(msg, type) {
      const div = document.getElementById("statusMessage");
      div.innerHTML = `<div class="status-message status-${type}">${type === 'success' ? '‚úÖ' : '‚ùå'} ${msg}</div>`;
      setTimeout(() => (div.innerHTML = ""), 3000);
    }

    function saveData() {
      localStorage.setItem("scooterEntries", JSON.stringify(entries));
    }

    function loadData() {
      const saved = localStorage.getItem("scooterEntries");
      if (saved) entries = JSON.parse(saved);
      updateDisplay();
    }

    function addEntry() {
      const odo = parseFloat(document.getElementById("odometer").value);
      const liters = parseFloat(document.getElementById("liters").value);
      const price = parseFloat(document.getElementById("price").value);
      const isFull = document.getElementById("fullTank").checked;

      if (isNaN(odo) || isNaN(liters) || isNaN(price)) {
        showStatus("Please enter odometer, liters, and price.", "error");
        return;
      }

      const newEntry = {
        id: Date.now(),
        date: new Date().toLocaleDateString("en-IN"),
        odometer,
        liters,
        price,
        fullTank: isFull,
        kmDriven: null,
        mileage: null,
      };

      entries.push(newEntry);
      calculateMileage();
      saveData();
      updateDisplay();

      ["odometer", "liters", "price"].forEach(id => document.getElementById(id).value = "");
      document.getElementById("fullTank").checked = false;

      showStatus("Entry added successfully!", "success");
    }

    function calculateMileage() {
      let lastFullIndex = -1;
      for (let i = 0; i < entries.length; i++) {
        entries[i].kmDriven = null;
        entries[i].mileage = null;
      }

      for (let i = 0; i < entries.length; i++) {
        if (entries[i].fullTank) {
          if (lastFullIndex !== -1) {
            const distance = entries[i].odometer - entries[lastFullIndex].odometer;
            const fuelUsed = entries
              .slice(lastFullIndex + 1, i + 1)
              .reduce((sum, e) => sum + e.liters, 0);
            entries[i].kmDriven = distance;
            entries[i].mileage = distance / fuelUsed;
          }
          lastFullIndex = i;
        }
      }
    }

    function updateStats() {
      const statsDiv = document.getElementById("statsGrid");
      
      if (entries.length === 0) {
        statsDiv.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #6b7280;">No data yet. Add your first entry!</p>';
        return;
      }

      const mileageEntries = entries.filter(e => e.mileage);
      const totalFuel = entries.reduce((sum, e) => sum + e.liters, 0);
      const totalSpent = entries.reduce((sum, e) => sum + e.price, 0);
      const avgMileage = mileageEntries.length > 0 
        ? mileageEntries.reduce((sum, e) => sum + e.mileage, 0) / mileageEntries.length 
        : 0;
      const totalKm = entries.length > 1 
        ? entries[entries.length - 1].odometer - entries[0].odometer 
        : 0;

      statsDiv.innerHTML = `
        <div class="stat-card">
          <div class="stat-value">${avgMileage.toFixed(1)}</div>
          <div class="stat-label">Avg Mileage (km/L)</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${totalKm.toFixed(0)}</div>
          <div class="stat-label">Total Distance (km)</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${totalFuel.toFixed(1)}</div>
          <div class="stat-label">Total Fuel (L)</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">‚Çπ${totalSpent.toFixed(0)}</div>
          <div class="stat-label">Total Spent</div>
        </div>
      `;
    }

    function downloadData() {
      const blob = new Blob([JSON.stringify(entries, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "full-tanker-" + new Date().toISOString().split("T")[0] + ".json";
      link.click();
      showStatus("Backup downloaded!", "success");
    }

    function exportCSV() {
      if (entries.length === 0) return showStatus("No data to export!", "error");
      const header = ["Date","Odometer","Fuel(L)","Price(‚Çπ)","FullTank","KM Driven","Mileage"];
      const rows = entries.map(e =>
        [e.date,e.odometer,e.liters,e.price,e.fullTank ? "Yes":"No",
         e.kmDriven ?? "", e.mileage ? e.mileage.toFixed(2) : ""].join(",")
      );
      const csv = [header.join(","), ...rows].join("\n");
      const blob = new Blob([csv], { type: "text/csv" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "full-tanker.csv";
      link.click();
      showStatus("CSV downloaded!", "success");
    }

    function resetAll() {
      if (!confirm("Are you sure you want to clear all data? This cannot be undone!")) return;
      localStorage.removeItem("scooterEntries");
      entries = [];
      updateDisplay();
      showStatus("All data cleared!", "success");
    }

    function updateDisplay() {
      updateStats();
      
      const div = document.getElementById("historyContent");
      if (entries.length === 0) {
        div.innerHTML = "<p style='text-align: center; color: #6b7280; padding: 20px;'>No entries yet. Start tracking your mileage!</p>";
        drawChart([]);
        return;
      }

      const rows = entries.map((e, i) => `
        <tr>
          <td>${i + 1}</td>
          <td>${e.date}</td>
          <td>${e.odometer.toFixed(1)}</td>
          <td>${e.liters.toFixed(2)}</td>
          <td>‚Çπ${e.price.toFixed(2)}</td>
          <td>${e.fullTank ? "‚úÖ" : "‚Äî"}</td>
          <td>${e.kmDriven ? e.kmDriven.toFixed(1) : "‚Äî"}</td>
          <td>${e.mileage ? e.mileage.toFixed(2) + " km/L" : "‚Äî"}</td>
        </tr>
      `).join("");

      div.innerHTML = `<table>
        <thead><tr>
          <th>#</th><th>Date</th><th>Odometer</th><th>Fuel</th><th>Price</th>
          <th>Full</th><th>KM Driven</th><th>Mileage</th>
        </tr></thead><tbody>${rows}</tbody></table>`;

      const fullMileageData = entries.filter(e => e.mileage);
      drawChart(fullMileageData);
    }

    let chart;
    function drawChart(data) {
      const ctx = document.getElementById("mileageChart");
      if (chart) chart.destroy();
      if (data.length === 0) return;

      const labels = data.map(e => e.date);
      const mileageVals = data.map(e => e.mileage);
      const avgVals = mileageVals.map((_, i) => {
        const subset = mileageVals.slice(0, i + 1);
        return subset.reduce((a,b)=>a+b,0) / subset.length;
      });

      chart = new Chart(ctx, {
        type: "line",
        data: {
          labels,
          datasets: [
            {
              label: "Mileage (km/L)",
              data: mileageVals,
              borderColor: "#667eea",
              backgroundColor: "rgba(102,126,234,0.2)",
              fill: true,
              tension: 0.4,
              borderWidth: 3,
            },
            {
              label: "Average Mileage",
              data: avgVals,
              borderColor: "#f59e0b",
              borderDash: [8, 4],
              fill: false,
              tension: 0.4,
              borderWidth: 2,
            }
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: { 
            y: { 
              beginAtZero: false,
              grid: {
                color: '#e5e7eb'
              }
            },
            x: {
              grid: {
                display: false
              }
            }
          },
          plugins: {
            legend: { 
              position: "top",
              labels: {
                usePointStyle: true,
                padding: 15,
                font: {
                  size: 13,
                  weight: 600
                }
              }
            },
            tooltip: { 
              mode: "index", 
              intersect: false,
              backgroundColor: 'rgba(0,0,0,0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              }
            }
          }
        },
      });
    }

    window.onload = loadData;
  </script>
</body>
</html>
